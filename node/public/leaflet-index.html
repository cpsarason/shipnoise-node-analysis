
<!DOCTYPE html>
<html>
<head>

	<title>Seventy48 Race -- Tacoma to Port Townsend</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.css"/>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.js"></script>

 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.css" />

	<script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.js" charset="utf-8"></script>
    <script src="js/jquery.min.js"></script>
</head>
<body>
<style>
	body {
    padding: 0;
    margin: 0;
	}
	html, body, #mapid {
	    height: 100%;
	    width: 100vw;
	}

	</style>
<div id="mapid"></div>
<script>

const AISShipTrack = 
('http://localhost:3001/api/broadcasts?geoJson=true');
const AISgeoJSONFeatures = await AISShipTrack.responseJSON.features;

var kayakTrack = {  "type": "FeatureCollection",
"features": [
	{
		"type": "Feature",
		"properties": {},
		"geometry": {
			"type": "LineString",
			"coordinates": [
				[
					-122.43232727050781,
					47.246726811046884
				],
				[
					-122.43370056152344,
					47.25360169808079
				],
				[
					-122.43455886840819,
					47.25663102603915
				],
				[
					-122.43885040283203,
					47.26257266598805
				],
				[
					-122.44657516479494,
					47.272124493121325
				],
				[
					-122.47713088989258,
					47.28679833178004
				],
				[
					-122.50820159912108,
					47.309965390979684
				],
				[
					-122.54116058349608,
					47.32509416935555
				],
				[
					-122.55695343017577,
					47.326955873477544
				],
				[
					-122.53772735595703,
					47.36278088960837
				],
				[
					-122.52708435058594,
					47.44480754169437
				],
				[
					-122.49069213867188,
					47.51673695680999
				],
				[
					-122.47833251953125,
					47.53806480221706
				],
				[
					-122.4810791015625,
					47.55521351530769
				],
				[
					-122.4755859375,
					47.58764167941513
				],
				[
					-122.48657226562499,
					47.63948497925488
				],
				[
					-122.50167846679686,
					47.70190636450079
				],
				[
					-122.46528625488281,
					47.75455961892611
				],
				[
					-122.47833251953125,
					47.81684332352077
				],
				[
					-122.52433776855469,
					47.91450120703987
				],
				[
					-122.71865844726561,
					48.017946316196635
				],
				[
					-122.72475242614748,
					48.024720482272315
				],
				[
					-122.73196220397948,
					48.03201032743533
				],
				[
					-122.74972915649413,
					48.046644304499615
				],
				[
					-122.7509307861328,
					48.047562376233046
				],
				[
					-122.75711059570312,
					48.0762438718672
				],
				[
					-122.75024414062499,
					48.11384975871469
				]
			]
		}
	}
	]
}

var map = L.map('mapid').setView([47.646711194756, -122.45223999023436], 8);
var drawnItems = L.featureGroup().addTo(map);


// var Esri_OceanBasemap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/{z}/{y}/{x}', {
// 	attribution: 'Tiles &copy; Esri &mdash; Sources: GEBCO, NOAA, CHS, OSU, UNH, CSUMB, National Geographic, DeLorme, NAVTEQ, and Esri',
// 	maxZoom: 13
// }).addTo(map);


//mapbox://styles/cpsarason/cjfvnf3vn06dp2rnk2kcq110a
//https://api.mapbox.com/styles/v1/cpsarason/cji3d2cji0olj2so1gd6llcn0/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY3BzYXJhc29uIiwiYSI6IjM5ZGM2MTgxNGIxMTUyM2NhYzU3N2U0Y2VjODY2Zjc2In0.XjvKMZgY5p-AmHgX5fqgtQ


var MapBoxDark = L.tileLayer('https://api.mapbox.com/styles/v1/cpsarason/cji42q7r425ha2rqx65dnemun/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY3BzYXJhc29uIiwiYSI6IjM5ZGM2MTgxNGIxMTUyM2NhYzU3N2U0Y2VjODY2Zjc2In0.XjvKMZgY5p-AmHgX5fqgtQ',{
 attribution: 'Map data: &copy; <a href="http:/www.mapbox.com">Mapbox</a>'
}).addTo(map);

var MapBoxSat = L.tileLayer('https://api.mapbox.com/styles/v1/cpsarason/cji3cm53i0bgn2rofv1ocslej/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY3BzYXJhc29uIiwiYSI6IjM5ZGM2MTgxNGIxMTUyM2NhYzU3N2U0Y2VjODY2Zjc2In0.XjvKMZgY5p-AmHgX5fqgtQ',{
 attribution: 'Map data: &copy; <a href="http:/www.mapbox.com">Mapbox</a>'
}).addTo(map);

var NOAANavChart = L.tileLayer('http://tileservice.charts.noaa.gov/tiles/50000_1/{z}/{x}/{y}.png', {
	attribution: 'NOAA Chart Data courtesy of NOAA'
}).addTo(map);

var MapBoxOutside = L.tileLayer('https://api.mapbox.com/styles/v1/cpsarason/cji3d2cji0olj2so1gd6llcn0/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY3BzYXJhc29uIiwiYSI6IjM5ZGM2MTgxNGIxMTUyM2NhYzU3N2U0Y2VjODY2Zjc2In0.XjvKMZgY5p-AmHgX5fqgtQ',{
 attribution: 'Map data: &copy; <a href="http:/www.mapbox.com">Mapbox</a>'
}).addTo(map);
// var OpenSeaMap = L.tileLayer('https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png', {
// 	attribution: 'Map data: &copy; <a href="http://www.openseamap.org">OpenSeaMap</a> contributors'
// }).addTo(map);



var locControl = L.control.locate().addTo(map);

var kayakStyle = {
 "color": "#62e4fd",
 "weight": 5,
 "opacity": 0.65
};

var geojsonMarkerOptions = {
    radius: 8,
    fillColor: "#ff7800",
    color: "#000",
    weight: 1,
    opacity: 1,
    fillOpacity: 0.8
};


L.geoJSON(AISgeoJSONFeatures).addTo(map);

L.geoJSON(kayakTrack, {
   style: kayakStyle}).addTo(map);

L.control.layers({
	'MapBox Dark': MapBoxDark,
	'MapBox Sat': MapBoxSat,
	'NOAA Chart': NOAANavChart,
}, {
	 'MapBox Overlay': MapBoxOutside,

}, {
	 position: 'topright',
	 collapsed: true
 }).addTo(map);

// map.addControl(new L.Control.Draw({
// 		edit: {
// 				featureGroup: drawnItems,
// 				poly: {
// 						allowIntersection: false
// 				}
// 		},
// 		draw: {
// 				polygon: {
// 						allowIntersection: false,
// 						showArea: true
// 				}
// 		}
// }));
//
// map.on(L.Draw.Event.CREATED, function (event) {
// 		var layer = event.layer;
// 		drawnItems.addLayer(layer);
// });


</script>



</body>
</html>
